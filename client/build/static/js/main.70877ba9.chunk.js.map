{"version":3,"sources":["axios.js","store/actions/actions.js","store/actions/actionTypes.js","containers/Header/Header.js","components/UI/Input/Input.js","containers/Auth/form.js","containers/Auth/Auth.js","components/Conversation/ChatString/ChatString.js","components/Conversation/ChatSubmit/ChatSubmit.js","containers/Chat/Chat.js","App.js","store/reducer.js","index.js","components/UI/Input/Input.module.css","containers/Chat/Chat.module.css","containers/Auth/Auth.module.css","containers/Header/Header.module.css","components/Conversation/ChatString/ChatString.module.css","img/header.svg","components/Conversation/ChatSubmit/chatSubmit.module.css"],"names":["instance","axios","create","headers","post","baseURL","removeUser","id","dispatch","get","userId","then","response","type","userRemoved","catch","err","console","log","newMsg","data","authenticated","token","user","exp","socket","localStorage","setItem","JSON","stringify","setUser","on","addUser","getUsers","Authorization","logoutUser","removeItem","Header","nav","this","props","className","classes","Nav","recipient","onClick","onUnsetRecipient","name","onLogoutUser","_id","src","HeaderImg","alt","Component","connect","state","actions","input","inputElement","inputClasses","InputElement","labelClasses","Label","invalid","shouldValidate","touched","push","Invalid","LabelInvalid","elementType","join","elementConfig","value","onChange","changed","options","map","option","key","displayValue","Input","placeholder","authForm","email","validation","required","valid","password","autoComplete","Auth","formError","isLogin","inputChangedHandler","event","inputIdentifier","updatedAuthForm","target","checkValidity","setState","submitHandler","preventDefault","onAuthenticated","onGetUsers","error","dir","switchFormHandler","prevState","nextForm","rules","isValid","trim","minLength","length","formElementsArray","config","form","formElement","authRedirect","isAuthenticated","to","errorMsg","FormArea","onSubmit","Submit","style","fontSize","chatString","stringStyle","String","children","chatSubmit","React","forwardRef","ref","val","change","send","Chat","currentMsg","scrollToPosition","_chatWindow","scrollTop","scrollHeight","startChatHandler","msg","_input","focus","emit","onNewMsg","currentMsgHandler","identifier","prevProps","messages","sort","a","b","timestamp","ChatString","chatWindow","ChatSubmit","userList","Object","entries","onlineUsers","filter","onSetRecipient","Unread","Main","chat","UserList","App","logoutRequest","onRemoveUser","socketIOClient","onSetSocket","getItem","Date","getTime","parse","window","addEventListener","path","component","withRouter","initialState","action","updatedUsers","newMessage","now","uuidv4","updatedMessages","thread","currentUser","storeUsers","unsetRecipient","setRecipient","setSocket","reducer","composeEnhancers","store","createStore","applyMiddleware","thunk","app","ReactDOM","render","document","getElementById","module","exports"],"mappings":"wSAoBeA,E,OATbC,EAAMC,OAAO,CACbC,QAAS,CACPC,KAAM,CACJ,8BAA+B,MAGnCC,QAAS,MCUEC,EAAa,SAACC,GACzB,OAAO,SAAAC,GACLP,EAAMQ,IAAI,gBAAkBF,EAAGG,QAAQC,MAAK,SAAAC,GAC1CJ,EAPc,SAACD,GACnB,MAAO,CAAEM,KCtBgB,cDsBeN,MAM3BO,CAAYP,EAAGG,YACvBK,OAAM,SAAAC,GAAG,OAAIC,QAAQC,IAAIF,QAQnBG,EAAS,SAACC,GACrB,MAAO,CAAEP,KCrCY,UDqCeO,SAGzBC,EAAgB,SAACC,EAAOC,EAAMC,EAAKC,GAM9C,OAJAC,aAAaC,QAAQ,QAASL,GAC9BI,aAAaC,QAAQ,OAAQC,KAAKC,UAAUN,IAC5CG,aAAaC,QAAQ,MAAOH,GAErB,SAAAhB,GACLA,EA/CY,SAACc,EAAOC,EAAMC,GAC5B,MAAO,CAAEX,KCJa,WDIeS,QAAOC,OAAMC,OA8CvCM,CAAQR,EAAOC,EAAMC,IAC9BC,EAAOM,GAAG,WAAW,SAAAX,GACnBZ,EAASW,EAAOC,OAElBK,EAAOM,GAAG,UAAU,SAAAxB,GAAE,OAAIC,EA3Cd,SAAAD,GACd,OAAO,SAAAC,GACLP,EAAMQ,IAAI,SAAWF,EAAGG,QAAQC,MAAK,SAAAC,GACnCJ,EANG,CAAEK,KCPa,WDOeU,KAMfX,EAASQ,UAC1BL,OAAM,SAAAC,GAAG,OAAIC,QAAQC,IAAIF,OAuCOgB,CAAQzB,OAC3CkB,EAAOM,GAAG,WAAW,SAAAxB,GAAE,OAAIC,EAASF,EAAWC,SAItC0B,EAAW,SAACX,GACvB,OAAO,SAAAd,GACLP,EAAMQ,IAAI,SAAU,CAClBN,QAAS,CACP+B,cAAe,UAAYZ,KAE5BX,MAAK,SAAAC,GACNJ,EA9BG,CAAEK,KC/BgB,cD+BeO,KA8BhBR,EAASQ,UAC5BL,OAAM,SAAAC,GAAG,OAAIC,QAAQC,IAAIF,QAYnBmB,EAAa,WAKxB,OAJAT,aAAaU,WAAW,SACxBV,aAAaU,WAAW,QACxBV,aAAaU,WAAW,OAEjB,CACLvB,KCjFuB,gB,4DCGrBwB,E,uKACK,IAEY,MAFb,OACFC,EAAM,KACPC,KAAKC,MAAMjB,OACZe,EACE,yBAAKG,UAAWC,IAAQC,MACpB,UAAAJ,KAAKC,MAAMI,iBAAX,eAAuB,IACvB,uBAAGC,QAASN,KAAKC,MAAMM,kBAAvB,QACA,KAEF,qCAAIP,KAAKC,MAAMI,iBAAf,iBAAI,EAAuB,UAA3B,aAAI,EAA2BG,MAC/B,uBAAGF,QAAS,wBAAM,EAAKL,MAAMQ,aAAX,UAAwB,EAAKR,MAAMjB,YAAnC,aAAwB,EAAiB0B,OAA3D,cAIN,OACE,yBAAKR,UAAWC,IAAQL,QACtB,yBAAKa,IAAKC,IAAWC,IAAI,oBACxBd,O,GAlBYe,aAsCNC,eAdS,SAAAC,GACtB,MAAO,CACLhC,KAAMgC,EAAMhC,KACZqB,UAAWW,EAAMX,cAIM,SAAApC,GACzB,MAAO,CACLsC,iBAAkB,kBAAMtC,EFoCnB,CAAEK,KCrEoB,qBCkC3BmC,aAAc,SAACzC,GAAD,OAAQC,EAASgD,SAIpBF,CAA6CjB,G,gCCe7CoB,EAzDD,SAACjB,GAEb,IAAIkB,EAAe,KACZC,EAAe,CAACjB,IAAQkB,cACzBC,EAAe,CAACnB,IAAQoB,OAO9B,OALGtB,EAAMuB,SAAWvB,EAAMwB,gBAAkBxB,EAAMyB,UAChDN,EAAaO,KAAKxB,IAAQyB,SAC1BN,EAAaK,KAAKxB,IAAQ0B,eAGpB5B,EAAM6B,aACZ,IAAK,QACHX,EAAe,yCACbjB,UAAWkB,EAAaW,KAAK,MACzB9B,EAAM+B,cAFG,CAGbC,MAAOhC,EAAMgC,MACbC,SAAUjC,EAAMkC,WAClB,MACF,IAAK,WACHhB,EAAe,4CACbjB,UAAWkB,EAAaW,KAAK,MACzB9B,EAAM+B,cAFG,CAGbC,MAAOhC,EAAMgC,MACbC,SAAUjC,EAAMkC,WAClB,MACF,IAAK,SACDhB,EACE,4BACEjB,UAAWkB,EAAaW,KAAK,KAC7BE,MAAOhC,EAAMgC,MACbC,SAAUjC,EAAMkC,SACflC,EAAM+B,cAAcI,QAAQC,KAAI,SAAAC,GAAM,OACrC,4BACEC,IAAKD,EAAOL,MACZA,MAAOK,EAAOL,OAAQK,EAAOE,kBAMvC,MACF,QACErB,EAAe,yCACbjB,UAAWC,IAAQkB,cACfpB,EAAM+B,cAFG,CAGbC,MAAOhC,EAAMgC,SAGnB,OACE,yBAAK/B,UAAWC,IAAQsC,OACtB,2BAAOvC,UAAWoB,EAAaS,KAAK,MAAO9B,EAAM+B,cAAcU,aAC9DvB,ICzBQwB,EA9BE,CACfC,MAAO,CACLd,YAAa,QACbE,cAAe,CACb1D,KAAM,QACNoE,YAAa,cAEfT,MAAO,GACPY,WAAY,CACVC,UAAU,GAEZC,OAAO,EACPrB,SAAS,GAEXsB,SAAU,CACRlB,YAAa,QACbE,cAAe,CACb1D,KAAM,WACNoE,YAAa,WACbO,aAAc,oBAEhBhB,MAAO,GACPY,WAAY,CACVC,UAAU,GAEZC,OAAO,EACPrB,SAAS,I,iBCjBPwB,E,4MACJlC,MAAQ,CACN2B,SAAUA,EACVQ,UAAW,KACXC,SAAS,G,EAYXC,oBAAsB,SAACC,EAAOC,GAE5B,IAAMC,EAAe,2BAChB,EAAKxC,MAAM2B,UADK,kBAElBY,EAFkB,2BAGd,EAAKvC,MAAM2B,SAASY,IAHN,IAIjBtB,MAAOqB,EAAMG,OAAOxB,MACpBc,MAAO,EAAKW,cAAcJ,EAAMG,OAAOxB,MAAO,EAAKjB,MAAM2B,SAASY,GAAiBV,YACnFnB,SAAS,MAIb,EAAKiC,SAAS,CAAChB,SAAUa,K,EAG3BI,cAAgB,SAACN,GACfA,EAAMO,iBAEN,IAAMhF,EAAO,CACX+D,MAAO,EAAK5B,MAAM2B,SAASC,MAAMX,MACjCe,SAAU,EAAKhC,MAAM2B,SAASK,SAASf,OAGtC,EAAKjB,MAAMoC,QACZ1F,EAAMG,KAAK,SAAUgB,GAClBT,MAAK,SAAAC,GAEJ,EAAK4B,MAAM6D,gBAAgBzF,EAASQ,KAAKE,MAAOV,EAASQ,KAAKG,KAAMX,EAASQ,KAAKI,IAAK,EAAKgB,MAAMf,QAElGxB,EAAMQ,IAAI,eAAiBG,EAASQ,KAAKG,KAAK0B,IAAK,CACjD9C,QAAS,CACP+B,cAAe,UAAYtB,EAASQ,KAAKE,SAE1CX,MAAK,SAAAC,GACNK,QAAQC,IAAI,OAAQN,EAASQ,SAC5BL,OAAM,SAAAC,GAAG,OAAIC,QAAQC,IAAIF,MAG5B,EAAKwB,MAAM8D,WAAW1F,EAASQ,KAAKE,UAGrCP,OAAM,SAAAwF,GACLtF,QAAQuF,IAAI,QAASD,GACrB,EAAKL,SAAS,CAAER,UAAWa,EAAM3F,SAASQ,WAG9CA,EAAI,KAAW,EAAKmC,MAAM2B,SAASnC,KAAKyB,MACxCvE,EAAMG,KAAK,YAAagB,GACrBT,MAAK,SAAAC,GACJ,EAAKsF,SAAS,CAAEP,SAAS,OAE1B5E,OAAM,SAAAwF,GACLtF,QAAQuF,IAAID,GACZ,EAAKL,SAAS,CAAER,UAAWa,EAAM3F,SAASQ,Y,EAMlDqF,kBAAoB,WAElB,EAAKP,UAAS,SAAAQ,GACZ,IAAIC,EAAW,GAqBf,OApBGD,EAAUf,QACXgB,EAAQ,aACN5D,KAAM,CACJsB,YAAa,QACbE,cAAe,CACb1D,KAAM,OACNoE,YAAa,aAEjBT,MAAO,GACPY,WAAY,CACVC,UAAU,GAEZC,OAAO,EACPrB,SAAS,IACL,EAAKV,MAAM2B,iBAGjByB,EAAQ,eAAO,EAAKpD,MAAM2B,WACVnC,KAEX,CAAC4C,SAAUe,EAAUf,QAAST,SAAUyB,O,4DA5FrCnC,EAAOoC,GACnB,IAAIC,GAAU,EAKd,OAHGD,EAAMvB,WAAWwB,EAA2B,KAAjBrC,EAAMsC,QAAiBD,GAClDD,EAAMG,YAAYF,EAAUrC,EAAMwC,QAAUJ,EAAMG,WAAaF,GAE3DA,I,+BA0FA,IAAD,OAEAI,EAAoB,GAC1B,IAAI,IAAInC,KAAOvC,KAAKgB,MAAM2B,SACxB+B,EAAkB/C,KAAK,CACrB3D,GAAIuE,EACJoC,OAAQ3E,KAAKgB,MAAM2B,SAASJ,KAIhC,IAAIqC,EAAOF,EAAkBrC,KAAI,SAAAwC,GAAW,OAC1C,kBAACpC,EAAD,CACEF,IAAKsC,EAAY7G,GACjB8D,YAAa+C,EAAYF,OAAO7C,YAChCE,cAAe6C,EAAYF,OAAO3C,cAClCC,MAAO4C,EAAYF,OAAO1C,MAC1BT,SAAUqD,EAAYF,OAAO5B,MAC7BtB,eAAgBoD,EAAYF,OAAO9B,WACnCnB,QAASmD,EAAYF,OAAOjD,QAC5BS,QAAS,SAACmB,GAAD,OAAW,EAAKD,oBAAoBC,EAAOuB,EAAY7G,UAGhE8G,EAAe,KAChB9E,KAAKC,MAAM8E,kBACZD,EAAe,kBAAC,IAAD,CAAUE,GAAG,OAG9B,IAAIC,EAAW,KAKf,OAJGjF,KAAKgB,MAAMmC,YACZ8B,EAAW,2BAAIjF,KAAKgB,MAAMmC,YAI1B,yBAAKjD,UAAWC,IAAQ+C,MACpB4B,EACF,yBAAK5E,UAAWC,IAAQ+E,UACpBD,EACF,0BAAME,SAAUnF,KAAK4D,eACjB5D,KAAKC,MAAM8E,gBAAkB,KAAOH,EACtC,4BAAQ1E,UAAWC,IAAQiF,OAAQ9G,KAAK,UAAU0B,KAAKgB,MAAMoC,QAAU,QAAU,WAEnF,uBAAG9C,QAASN,KAAKkE,kBAAmBmB,MAAO,CAACC,SAAU,SAAUtF,KAAKgB,MAAMoC,QAAU,oBAAsB,yB,GAhJlGtC,aAqKJC,eAdS,SAAAC,GACtB,MAAO,CACL+D,gBAAiC,OAAhB/D,EAAMjC,MACvBG,OAAQ8B,EAAM9B,WAIS,SAAAjB,GACzB,MAAO,CACL6F,gBAAiB,SAAC/E,EAAOC,EAAMC,EAAKC,GAAnB,OAA8BjB,EAASgD,EAAsBlC,EAAOC,EAAMC,EAAKC,KAChG6E,WAAY,SAAChF,GAAD,OAAWd,EAASgD,EAAiBlC,QAItCgC,CAA6CmC,G,iBCjK7CqC,EAVI,SAACtF,GAClBvB,QAAQC,IAAI,aAAcsB,GAC1B,IAAMuF,EAAcrF,IAAQF,EAAMuF,aAClC,OACE,yBAAKtF,UAAWsF,EAAc,IAAMrF,IAAQsF,QAC1C,2BAAIxF,EAAMyF,Y,iBCWDC,EAhBIC,IAAMC,YAAW,SAAC5F,EAAO6F,GAC1C,OACE,yBAAK5F,UAAWC,IAAQiF,QACpB,2BACEU,IAAKA,EACLxH,KAAK,OACL2D,MAAOhC,EAAM8F,IACb7D,SAAUjC,EAAM+F,SAClB,4BACE1F,QAASL,EAAMgG,MADjB,gB,iBCHFC,E,4MAEJlF,MAAQ,CACNmF,WAAY,I,EAadC,iBAAmB,WACI,IAAD,EAAjB,EAAKC,cACN,EAAKA,YAAYC,UAAjB,UAA6B,EAAKD,mBAAlC,aAA6B,EAAkBE,e,EAInDC,iBAAmB,SAACC,EAAKzH,EAAMqB,GAC7B,EAAKqG,OAAOC,QAEZ,IAAMR,EAAU,eAAO,EAAKnF,MAAMmF,YAClCA,EAAW9F,GAAa,GACxB,EAAKsD,SAAS,CAAEwC,WAAYA,IAE5B,EAAKlG,MAAMf,OAAO0H,KAAK,OAAQ,CAAEH,MAAKzH,OAAMqB,cAC5C,EAAKJ,MAAM4G,SAAS,CAAEJ,MAAKzH,OAAMqB,e,EAGnCyG,kBAAoB,SAACxD,EAAOyD,GAC1B,IAAMZ,EAAU,eAAO,EAAKnF,MAAMmF,YAClCA,EAAWY,GAAczD,EAAMG,OAAOxB,MACtC,EAAK0B,SAAS,CAAEwC,WAAYA,K,kEA7B5BnG,KAAKoG,qB,yCAGYY,GACbA,EAAUC,WAAajH,KAAKC,MAAMgH,UACpCjH,KAAKoG,qB,+BA2BA,IAAD,aACFtB,EAAe,KACf9E,KAAKC,MAAM8E,kBACbD,EAAe,kBAAC,IAAD,CAAUE,GAAG,WAG9B,IAAIiC,EAAQ,UAAGjH,KAAKC,MAAMgH,gBAAd,aAAG,YAAsBjH,KAAKC,MAAMI,iBAAjC,aAAsB,EAAuB,IACzD4G,IACDA,EAAWA,EACVC,MAAK,SAACC,EAAEC,GAAH,OAASD,EAAEE,UAAYD,EAAEC,aAC9BhF,KAAI,SAAAoE,GAAQ,IAAD,EACNpB,EAAQ,KAMZ,OAJEA,EADCoB,EAAIzH,QAAJ,UAAa,EAAKiB,MAAMjB,YAAxB,aAAa,EAAiB0B,KACvB,QAEA,OAEH,kBAAC4G,EAAD,CAAY/E,IAAKkE,EAAIzI,GAAIwH,YAAaH,GAAQoB,EAAIA,SAI7D,IAC6B,QADzBc,EAAa,MACjB,UAAGvH,KAAKC,MAAMI,iBAAd,aAAG,EAAuB,MACxBkH,EACE,6BACIN,EACF,8BACA,kBAACO,EAAD,CACEvB,KAAO,4BAAM,EAAKO,iBAAL,UACT,EAAKxF,MAAMmF,kBADF,aACT,YAAwB,EAAKlG,MAAMI,iBAAnC,aAAwB,EAAuB,IAC/C,EAAKJ,MAAMjB,KAAK0B,IAFP,UAEY,EAAKT,MAAMI,iBAFvB,aAEY,EAAuB,KAChD0F,KAAM,UAAA/F,KAAKgB,MAAMmF,kBAAX,yBAAwBnG,KAAKC,MAAMI,iBAAnC,aAAwB,EAAuB,KAA/C,UACJL,KAAKgB,MAAMmF,kBADP,aACJ,YAAwBnG,KAAKC,MAAMI,iBAAnC,aAAwB,EAAuB,IAC/C,GACF2F,OAAQ,SAAC1C,GAAD,aAAW,EAAKwD,kBAAkBxD,EAAvB,UAA8B,EAAKrD,MAAMI,iBAAzC,aAA8B,EAAuB,KACxEyF,IAAK,SAAC5E,GAAD,OAAW,EAAKwF,OAASxF,OAMtC,IAAIuG,EAAW,4DAqBf,OApBGC,OAAOC,QAAQ3H,KAAKC,MAAM2H,aAAanD,OAAS,IACjDgD,EAAWC,OAAOC,QAAQ3H,KAAKC,MAAM2H,aACpCC,QAAO,SAAA7I,GAAI,aAAIA,EAAK,MAAL,UAAY,EAAKiB,MAAMjB,YAAvB,aAAY,EAAiB0B,QAC5C2B,KAAI,SAAArD,GAAS,IAAD,EACPqG,EAAQ,KAIZ,OAHGrG,EAAK,MAAL,UAAY,EAAKiB,MAAMI,iBAAvB,aAAY,EAAuB,MACpCgF,EAAQ,CAAC,WAAc,SAGvB,wBAAI9C,IAAKvD,EAAK,GAAIqG,MAAOA,EAAO/E,QAAS,kBAAM,EAAKL,MAAM6H,eAAe9I,EAAM,EAAKiB,MAAMf,UACvFF,EAAK,GAAL,KAECA,EAAK,GAAL,OACA,0BAAMkB,UAAWC,IAAQ4H,QAAS/I,EAAK,GAAL,QAClC,UAOR,yBAAKkB,UAAWC,IAAQ+F,MACtBpB,EACC9E,KAAKC,MAAMI,UAIZ,yBACEH,UAAWC,IAAQ6H,KACnBlC,IAAK,SAACmC,GAAD,OAAU,EAAK5B,YAAc4B,IAChCV,GANJ,yBAAKrH,UAAWC,IAAQ+H,UACtB,4BAAMT,S,GA1GG3G,aA4IJC,eArBS,SAAAC,GACtB,MAAO,CACL+D,gBAAiC,OAAhB/D,EAAMjC,MACvBA,MAAOiC,EAAMjC,MACbG,OAAQ8B,EAAM9B,OACdF,KAAMgC,EAAMhC,KACZ4I,YAAa5G,EAAM4G,YACnBvH,UAAWW,EAAMX,UACjB4G,SAAUjG,EAAMiG,aAIO,SAAAhJ,GACzB,MAAO,CACLwC,aAAc,SAACzC,GAAD,OAAQC,EAASgD,MAC/B8C,WAAY,SAAChF,GAAD,OAAWd,EAASgD,EAAiBlC,KACjD+I,eAAgB,SAACzH,EAAWnB,GAAZ,OAAuBjB,ERxEf,SAACoC,EAAWnB,GACtC,MAAO,CAAEZ,KClEkB,gBDkEe+B,aQuEQY,CAAqBZ,KACrEwG,SAAU,SAAChI,GAAD,OAAUZ,EAASgD,EAAepC,QAIjCkC,CAA6CmF,GCvItDiC,E,4MAiCJC,cAAgB,SAACpJ,EAAMD,GAClBC,GAAQD,GACT,EAAKkB,MAAMoI,aAAarJ,EAAMD,I,0EAjCN,IAAD,OAEnBG,EAEJoJ,IAAe,KAEjBtI,KAAKC,MAAMsI,YAAYrJ,GAEvB,IAAMH,EAAQI,aAAaqJ,QAAQ,SAEnC,GAAGzJ,EAAM,CACP,IAAME,EAAME,aAAaqJ,QAAQ,OACjC,GAAGvJ,GAAO,IAAIwJ,MAAOC,UAAY,IAAM,CACrC,IAAM1J,EAAOK,KAAKsJ,MAAMxJ,aAAaqJ,QAAQ,SAC7CxI,KAAKC,MAAM6D,gBAAgB/E,EAAOC,EAAMC,EAAKC,GAE7CxB,EAAMQ,IAAI,eAAiBc,EAAK0B,IAAK,CACnC9C,QAAS,CACP+B,cAAe,UAAYZ,KAE5BX,MAAK,SAAAC,GACNK,QAAQC,IAAIN,EAASQ,SACpBL,OAAM,SAAAC,GAAG,OAAIC,QAAQC,IAAIF,MAE5BuB,KAAKC,MAAM8D,WAAWhF,IAI1B6J,OAAOC,iBAAiB,gBAAgB,wBAAM,EAAKT,cAAL,UAAmB,EAAKnI,MAAMjB,YAA9B,aAAmB,EAAiB0B,IAAK,EAAKT,MAAMlB,Y,+BAUlG,OACE,yBAAKmB,UAAU,OACb,kBAAC,EAAD,MACA,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAO4I,KAAK,QAAQC,UAAW7F,IAC/B,kBAAC,IAAD,CAAO4F,KAAK,IAAIC,UAAW7C,IAC3B,kBAAC,IAAD,CAAUlB,GAAG,Y,GA9CLlE,aAsEHkI,cAAWjI,aAjBF,SAAAC,GACtB,MAAO,CACL+D,gBAAiC,OAAhB/D,EAAMjC,MACvBC,KAAMgC,EAAMhC,KACZD,MAAOiC,EAAMjC,UAIU,SAAAd,GACzB,MAAM,CACJoK,aAAc,SAACrK,EAAIe,GAAL,OAAed,EAASgD,EAAmB,CAAC9C,OAAQH,MAClEuK,YAAa,SAACrJ,GAAD,OAAajB,ET1DL,SAACiB,GACxB,MAAO,CAAEZ,KCZe,aDYeY,USyDF+B,CAAkB/B,KACrD4E,gBAAiB,SAAC/E,EAAOC,EAAMC,EAAKC,GAAnB,OAA8BjB,EAASgD,EAAsBlC,EAAOC,EAAMC,EAAKC,KAChG6E,WAAY,SAAChF,GAAD,OAAWd,EAASgD,EAAiBlC,QAI3BgC,CAA4CoH,I,kBChFhEc,GAAe,CACnBlK,MAAO,KACPC,KAAM,KACNqB,UAAW,KACXnB,OAAQ,KACR0I,YAAa,GACbX,SAAU,IAGN1H,GAAU,SAACyB,EAAOkI,GAMtB,OALAlI,EAAM9B,OAAO0H,KAAK,OAAQ,CACxBpG,KAAM0I,EAAOlK,KAAKwB,KAClBxC,GAAIkL,EAAOlK,KAAK0B,MAGX,2BACFM,GADL,IAEEjC,MAAOmK,EAAOnK,MACdC,KAAMkK,EAAOlK,QAIXS,GAAU,SAACuB,EAAOkI,GACtB,IAAMC,EAAY,2BAAOnI,EAAM4G,aAAgBsB,EAAOlK,MACtD,OAAO,2BACFgC,GADL,IAEE4G,YAAauB,KAIXpL,GAAa,SAACiD,EAAOkI,GACzB,IAAMtB,EAAW,eAAO5G,EAAM4G,aAE9B,cADOA,EAAYsB,EAAOlL,IACnB,2BACFgD,GADL,IAEE4G,YAAaA,KAIXhJ,GAAS,SAACoC,EAAOkI,GAAY,IAAD,EACCA,EAAOrK,KAAhC4H,EADwB,EACxBA,IAAKzH,EADmB,EACnBA,KAAMqB,EADa,EACbA,UACblC,EAAS6C,EAAMhC,KAAK0B,IAEpB0I,EAAa,CAAE/B,UADHoB,KAAKY,MACSrK,OAAMyH,MAAKzI,GAAIsL,gBACzCC,EAAe,eAAOvI,EAAMiG,UAC5BkC,EAAY,eAAOnI,EAAM4G,aAE3B4B,EAAS,KAEb,GAAGrL,IAAWa,EACZwK,EAASnJ,MACN,CAAC,IAAD,EAEH,GADAmJ,EAASxK,EACNA,KAAI,UAAKgC,EAAMX,iBAAX,aAAK,EAAkB,IAAG,CAC/B,IAAMoJ,EAAW,eAAOzI,EAAM4G,YAAY5I,IAC1CyK,EAAW,OACXA,EAAW,SACXA,EAAW,OAAa,EAExBN,EAAanK,GAAQyK,EAEvB/K,QAAQC,IAAI,SAAUwK,GAOxB,OAJAnI,EAAMiG,SAASuC,GACfD,EAAgBC,GAAhB,sBAA8BxI,EAAMiG,SAASuC,IAA7C,CAAsDJ,IACtDG,EAAgBC,GAAU,CAACJ,GAEpB,2BACFpI,GADL,IAEEiG,SAAUsC,EACV3B,YAAauB,KAIXvJ,GAAa,SAACoB,EAAOkI,GAEzB,OADAlI,EAAM9B,OAAO0H,KAAK,YAAa5F,EAAMhC,KAAK0B,KACnC,2BACFM,GADL,IAEEjC,MAAO,KACPC,KAAM,KACNqB,UAAW,QAITqJ,GAAa,SAAC1I,EAAOkI,GACzB,OAAO,2BACFlI,GADL,IAEE4G,YAAasB,EAAOrK,QAIlB8K,GAAiB,SAAC3I,EAAOkI,GAC7B,OAAO,2BACFlI,GADL,IAEEX,UAAW,QAITuJ,GAAe,SAAC5I,EAAOkI,GAC3B,IAAMC,EAAY,eAAOnI,EAAM4G,aACzB6B,EAAW,eAAOzI,EAAM4G,YAAYsB,EAAO7I,UAAU,KAO3D,OALAoJ,EAAW,QAAa,EACxBN,EAAaD,EAAO7I,UAAU,IAAMoJ,EAEpC/K,QAAQC,IAAI8K,GAEL,2BACFzI,GADL,IAEEX,UAAW6I,EAAO7I,UAClBuH,YAAauB,KAIXU,GAAY,SAAC7I,EAAOkI,GACxB,OAAO,2BACFlI,GADL,IAEE9B,OAAQgK,EAAOhK,UAmBJ4K,GAfC,WAAmC,IAAlC9I,EAAiC,uDAAzBiI,GAAcC,EAAW,uCAChD,OAAQA,EAAO5K,MACb,IT1HuB,cS0HO,OAAOoL,GAAW1I,EAAOkI,GACvD,IThIoB,WSgIO,OAAO3J,GAAQyB,EAAOkI,GACjD,IThIoB,WSgIO,OAAOzJ,GAAQuB,EAAOkI,GACjD,IThIuB,cSgIO,OAAOnL,GAAWiD,EAAOkI,GACvD,IThImB,USgIO,OAAOtK,GAAOoC,EAAOkI,GAC/C,IThIuB,cSgIO,OAAOtJ,GAAWoB,GAChD,IT/HyB,gBS+HO,OAAO4I,GAAa5I,EAAOkI,GAC3D,IT/H2B,kBS+HO,OAAOS,GAAe3I,GACxD,IT/HsB,aS+HO,OAAO6I,GAAU7I,EAAOkI,GACrD,QAAS,OAAOlI,IC7Hd+I,GAEJ,KAEIC,GAAQC,YAAYH,GAAQC,GAAiBG,YAAgBC,OAE7DC,GACJ,kBAAC,IAAD,CAAUJ,MAAOA,IACf,kBAAC,IAAD,KACE,kBAAC,EAAD,QAKNK,IAASC,OAAOF,GAAKG,SAASC,eAAe,U,mBCxB7CC,EAAOC,QAAU,CAAC,MAAQ,qBAAqB,MAAQ,qBAAqB,aAAe,4BAA4B,aAAe,4BAA4B,QAAU,yB,mBCA5KD,EAAOC,QAAU,CAAC,KAAO,mBAAmB,SAAW,uBAAuB,KAAO,qB,mBCArFD,EAAOC,QAAU,CAAC,KAAO,mBAAmB,SAAW,uBAAuB,OAAS,uB,mBCAvFD,EAAOC,QAAU,CAAC,OAAS,uBAAuB,IAAM,sB,mBCAxDD,EAAOC,QAAU,CAAC,OAAS,2BAA2B,KAAO,yBAAyB,MAAQ,4B,mBCD9FD,EAAOC,QAAU,IAA0B,oC,mBCC3CD,EAAOC,QAAU,CAAC,OAAS,6B","file":"static/js/main.70877ba9.chunk.js","sourcesContent":["import axios from 'axios';\n\nconst instance = process.env.NODE_ENV === 'development'\n? axios.create({\n  headers: {\n    post: {\n      'Access-Control-Allow-Origin': '*'\n    }\n  },\n  baseURL: 'http://127.0.0.1:4001/'\n})\n: axios.create({\n  headers: {\n    post: {\n      'Access-Control-Allow-Origin': '*'\n    }\n  },\n  baseURL: '/'\n});\n\nexport default instance;\n","import * as actionTypes from './actionTypes';\nimport axios from '../../axios';\n\nconst setUser = (token, user, exp) => {\n  return { type: actionTypes.SET_USER, token, user, exp }\n}\n\nconst userJoin = (user) => {\n  return { type: actionTypes.ADD_USER, user }\n}\n\nconst addUser = id => {\n  return dispatch => {\n    axios.get('/user/' + id.userId).then(response => {\n      dispatch(userJoin(response.data));\n    }).catch(err => console.log(err));\n  }\n}\n\nexport const setSocket = (socket) => {\n  return { type: actionTypes.SET_SOCKET, socket }\n}\n\nconst userRemoved = (id) => {\n  return { type: actionTypes.REMOVE_USER, id }\n}\n\nexport const removeUser = (id) => {\n  return dispatch => {\n    axios.get('/useroffline/' + id.userId).then(response => {\n      dispatch(userRemoved(id.userId));\n    }).catch(err => console.log(err));\n  }\n}\n\nconst storeUsers = (data) => {\n  return { type: actionTypes.STORE_USERS, data }\n}\n\nexport const newMsg = (data) => {\n  return { type: actionTypes.NEW_MSG, data }\n}\n\nexport const authenticated = (token, user, exp, socket) => {\n\n  localStorage.setItem('token', token);\n  localStorage.setItem('user', JSON.stringify(user));\n  localStorage.setItem('exp', exp);\n\n  return dispatch => {\n    dispatch(setUser(token, user, exp));\n    socket.on(\"new_msg\", data => {\n      dispatch(newMsg(data));\n    });\n    socket.on('emitOn', id => dispatch(addUser(id)));\n    socket.on('emitOff', id => dispatch(removeUser(id)));\n  }\n}\n\nexport const getUsers = (token) => {\n  return dispatch => {\n    axios.get('/users', {\n      headers: {\n        Authorization: 'Bearer ' + token\n      }\n    }).then(response => {\n      dispatch(storeUsers(response.data));\n    }).catch(err => console.log(err));\n  }\n}\n\nexport const setRecipient = (recipient, socket) => {\n  return { type: actionTypes.SET_RECIPIENT, recipient}\n}\n\nexport const unsetRecipient = (recipient, socket) => {\n  return { type: actionTypes.UNSET_RECIPIENT }\n}\n\nexport const logoutUser = () => {\n  localStorage.removeItem('token');\n  localStorage.removeItem('user');\n  localStorage.removeItem('exp');\n\n  return {\n    type: actionTypes.LOGOUT_USER\n  }\n}\n","export const SET_USER = 'SET_USER';\nexport const ADD_USER = 'ADD_USER';\nexport const REMOVE_USER = 'REMOVE_USER';\nexport const NEW_MSG = 'NEW_MSG';\nexport const LOGOUT_USER = 'LOGOUT_USER';\nexport const STORE_USERS = 'STORE_USERS';\nexport const SET_RECIPIENT = 'SET_RECIPIENT';\nexport const UNSET_RECIPIENT = 'UNSET_RECIPIENT';\nexport const SET_SOCKET = 'SET_SOCKET';\n","import React, {Component} from 'react';\nimport * as actions from '../../store/actions/actions';\nimport { connect } from 'react-redux';\n\nimport HeaderImg from '../../img/header.svg';\nimport classes from './Header.module.css';\n\nclass Header extends Component {\n  render(){\n    let nav = null;\n    if(this.props.user){\n      nav = (\n        <div className={classes.Nav}>\n          { this.props.recipient?.[0] ?\n            <p onClick={this.props.onUnsetRecipient}>back</p>:\n            null\n          }\n          <p>{this.props.recipient?.[1]?.name}</p>\n          <p onClick={() => this.props.onLogoutUser(this.props.user?._id)}>Logga ut</p>\n        </div>\n      );\n    }\n    return (\n      <div className={classes.Header}>\n        <img src={HeaderImg} alt=\"graphic pattern\"/>\n        {nav}\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  return {\n    user: state.user,\n    recipient: state.recipient\n  }\n}\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    onUnsetRecipient: () => dispatch(actions.unsetRecipient()),\n    onLogoutUser: (id) => dispatch(actions.logoutUser(id))\n  }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Header);\n","import React from  'react';\nimport classes from './Input.module.css';\n\nconst input = (props) => {\n\n  let inputElement = null;\n  const  inputClasses = [classes.InputElement];\n  const labelClasses = [classes.Label];\n\n  if(props.invalid && props.shouldValidate && props.touched){\n    inputClasses.push(classes.Invalid);\n    labelClasses.push(classes.LabelInvalid);\n  }\n\n  switch (props.elementType){\n    case('input'):\n      inputElement = <input\n        className={inputClasses.join(' ')}\n        {...props.elementConfig}\n        value={props.value}\n        onChange={props.changed}/>;\n      break;\n    case('textarea'):\n      inputElement = <textarea\n        className={inputClasses.join(' ')}\n        {...props.elementConfig}\n        value={props.value}\n        onChange={props.changed}/>;\n      break;\n    case('select'):\n        inputElement = (\n          <select\n            className={inputClasses.join(' ')}\n            value={props.value}\n            onChange={props.changed}>\n            {props.elementConfig.options.map(option => (\n              <option\n                key={option.value}\n                value={option.value}>{option.displayValue}\n                </option>\n            ))}\n\n          </select>\n        )\n      break;\n    default:\n      inputElement = <input\n        className={classes.InputElement}\n        {...props.elementConfig}\n        value={props.value}/>;\n  }\n\n  return (\n    <div className={classes.Input}>\n      <label className={labelClasses.join(' ')}>{props.elementConfig.placeholder}</label>\n      {inputElement}\n    </div>\n  );\n}\n\nexport default input;\n","const authForm = {\n  email: {\n    elementType: 'input',\n    elementConfig: {\n      type: 'email',\n      placeholder: 'Your Email'\n    },\n    value: '',\n    validation: {\n      required: true,\n    },\n    valid: false,\n    touched: false\n  },\n  password: {\n    elementType: 'input',\n    elementConfig: {\n      type: 'password',\n      placeholder: 'password',\n      autoComplete: 'current password'\n    },\n    value: '',\n    validation: {\n      required: true,\n    },\n    valid: false,\n    touched: false\n  }\n};\n\nexport default authForm;\n","import React, {Component} from 'react';\nimport axios from '../../axios';\nimport { connect } from 'react-redux';\nimport { Redirect } from 'react-router-dom';\nimport * as actions from '../../store/actions/actions';\nimport Input from '../../components/UI/Input/Input';\nimport authForm from './form';\nimport classes from './Auth.module.css';\n\nclass Auth extends Component {\n  state = {\n    authForm: authForm,\n    formError: null,\n    isLogin: true\n  }\n\n  checkValidity(value, rules){\n    let isValid = true;\n\n    if(rules.required){ isValid = value.trim() !== '' && isValid; }\n    if(rules.minLength){ isValid = value.length >= rules.minLength && isValid; }\n\n    return isValid;\n  }\n\n  inputChangedHandler = (event, inputIdentifier) => {\n\n    const updatedAuthForm = {\n      ...this.state.authForm,\n      [inputIdentifier]: {\n        ...this.state.authForm[inputIdentifier],\n        value: event.target.value,\n        valid: this.checkValidity(event.target.value, this.state.authForm[inputIdentifier].validation),\n        touched: true\n      }\n    };\n\n    this.setState({authForm: updatedAuthForm});\n  }\n\n  submitHandler = (event) => {\n    event.preventDefault();\n\n    const data = {\n      email: this.state.authForm.email.value,\n      password: this.state.authForm.password.value\n    }\n\n    if(this.state.isLogin){\n      axios.post('/login', data)\n        .then(response => {\n\n          this.props.onAuthenticated(response.data.token, response.data.user, response.data.exp, this.props.socket);\n\n          axios.get('/useronline/' + response.data.user._id, {\n            headers: {\n              Authorization: 'Bearer ' + response.data.token\n            }\n          }).then(response => {\n            console.log('resp', response.data);\n          }).catch(err => console.log(err)\n          );\n\n          this.props.onGetUsers(response.data.token);\n\n        })\n        .catch(error => {\n          console.dir('error', error);\n          this.setState({ formError: error.response.data })\n        });\n    }else{\n      data['name'] = this.state.authForm.name.value\n      axios.post('/register', data)\n        .then(response => {\n          this.setState({ isLogin: true })\n        })\n        .catch(error => {\n          console.dir(error)\n          this.setState({ formError: error.response.data })\n        });\n    }\n\n  }\n\n  switchFormHandler = () => {\n\n    this.setState(prevState => {\n      let nextForm = {};\n      if(prevState.isLogin){\n        nextForm = {\n          name: {\n            elementType: 'input',\n            elementConfig: {\n              type: 'name',\n              placeholder: 'Your Name'\n            },\n          value: '',\n          validation: {\n            required: true,\n          },\n          valid: false,\n          touched: false\n        }, ...this.state.authForm\n      };\n      }else{\n        nextForm = {...this.state.authForm};\n        delete nextForm.name;\n      }\n      return {isLogin: !prevState.isLogin, authForm: nextForm}\n    })\n  }\n\n  render(){\n\n    const formElementsArray = [];\n    for(let key in this.state.authForm){\n      formElementsArray.push({\n        id: key,\n        config: this.state.authForm[key]\n      });\n    }\n\n    let form = formElementsArray.map(formElement => (\n      <Input\n        key={formElement.id}\n        elementType={formElement.config.elementType}\n        elementConfig={formElement.config.elementConfig}\n        value={formElement.config.value}\n        invalid={!formElement.config.valid}\n        shouldValidate={formElement.config.validation}\n        touched={formElement.config.touched}\n        changed={(event) => this.inputChangedHandler(event, formElement.id)} />\n    ));\n\n    let authRedirect = null;\n    if(this.props.isAuthenticated){\n      authRedirect = <Redirect to=\"/\" />\n    }\n\n    let errorMsg = null;\n    if(this.state.formError){\n      errorMsg = <p>{this.state.formError}</p>\n    }\n\n    return (\n      <div className={classes.Auth}>\n        { authRedirect }\n        <div className={classes.FormArea}>\n          { errorMsg }\n          <form onSubmit={this.submitHandler}>\n            { this.props.isAuthenticated ? null : form }\n            <button className={classes.Submit} type=\"submit\">{this.state.isLogin ? 'Login' : 'Signup'}</button>\n          </form>\n          <p onClick={this.switchFormHandler} style={{fontSize: '12px'}}>{this.state.isLogin ? 'Switch to sign up' : 'Switch to login'}</p>\n        </div>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  return {\n    isAuthenticated: state.token !== null,\n    socket: state.socket\n  }\n}\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    onAuthenticated: (token, user, exp, socket) => dispatch(actions.authenticated(token, user, exp, socket)),\n    onGetUsers: (token) => dispatch(actions.getUsers(token))\n  }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Auth);\n","import React from  'react';\nimport classes from './ChatString.module.css';\n\nconst chatString = (props) => {\n  console.log('chatString', props);\n  const stringStyle = classes[props.stringStyle]\n  return (\n    <div className={stringStyle + ' ' + classes.String}>\n      <p>{props.children}</p>\n    </div>\n  );\n}\n\nexport default chatString;\n","import React from  'react';\nimport classes from './chatSubmit.module.css';\n\nconst chatSubmit = React.forwardRef((props, ref) => {\n  return (\n    <div className={classes.Submit}>\n        <input\n          ref={ref}\n          type=\"text\"\n          value={props.val}\n          onChange={props.change}></input>\n        <button\n          onClick={props.send}>send msg</button>\n\n    </div>\n\n  );\n});\n\nexport default chatSubmit;\n","import React, {Component} from 'react';\nimport { connect } from 'react-redux';\nimport { Redirect } from 'react-router-dom';\nimport * as actions from '../../store/actions/actions';\nimport ChatString from '../../components/Conversation/ChatString/ChatString';\nimport ChatSubmit from '../../components/Conversation/ChatSubmit/ChatSubmit';\nimport classes from './Chat.module.css';\n\nclass Chat extends Component {\n\n  state = {\n    currentMsg: {}\n  }\n\n  componentDidMount() {\n    this.scrollToPosition();\n  }\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.messages !== this.props.messages) {\n      this.scrollToPosition();\n    }\n  }\n\n  scrollToPosition = () => {\n    if(this._chatWindow){\n      this._chatWindow.scrollTop = this._chatWindow?.scrollHeight;\n    }\n  }\n\n  startChatHandler = (msg, user, recipient) => {\n    this._input.focus();\n\n    const currentMsg = {...this.state.currentMsg};\n    currentMsg[recipient] = '';\n    this.setState({ currentMsg: currentMsg });\n\n    this.props.socket.emit('chat', { msg, user, recipient });\n    this.props.onNewMsg({ msg, user, recipient });\n  }\n\n  currentMsgHandler = (event, identifier) => {\n    const currentMsg = {...this.state.currentMsg};\n    currentMsg[identifier] = event.target.value;\n    this.setState({ currentMsg: currentMsg });\n  }\n\n  render(){\n    let authRedirect = null;\n    if(!this.props.isAuthenticated){\n      authRedirect = <Redirect to=\"/auth\" />\n    }\n\n    let messages = this.props.messages?.[this.props.recipient?.[0]];\n    if(messages){\n      messages = messages\n      .sort((a,b) => a.timestamp - b.timestamp )\n      .map(msg => {\n        let style = null;\n        if(msg.user === this.props.user?._id){\n          style = 'Right';\n        }else{\n          style = 'Left';\n        }\n        return <ChatString key={msg.id} stringStyle={style}>{msg.msg}</ChatString>;\n      });\n    }\n\n    let chatWindow = null;\n    if(this.props.recipient?.[0]){\n      chatWindow = (\n        <div>\n          { messages }\n          <div></div>\n          <ChatSubmit\n            send={ () => this.startChatHandler(\n                this.state.currentMsg?.[this.props.recipient?.[0]],\n                this.props.user._id, this.props.recipient?.[0] )}\n            val={ this.state.currentMsg?.[this.props.recipient?.[0]] ?\n              this.state.currentMsg?.[this.props.recipient?.[0]] :\n              ''}\n            change={(event) => this.currentMsgHandler(event, this.props.recipient?.[0])}\n            ref={(input) => this._input = input}\n            />\n        </div>\n      );\n    }\n\n    let userList = <li>No users currently online...</li>;\n    if(Object.entries(this.props.onlineUsers).length > 1){\n      userList = Object.entries(this.props.onlineUsers)\n      .filter(user => user[0] !== this.props.user?._id)\n      .map(user => {\n        let style = null;\n        if(user[0] === this.props.recipient?.[0]){\n          style = {'fontWeight': 'bold'};\n        }\n        return (\n          <li key={user[0]} style={style} onClick={() => this.props.onSetRecipient(user, this.props.socket)}>\n            {user[1]['name']}\n            {\n              user[1]['unread'] ?\n              <span className={classes.Unread}>{user[1]['unread']}</span>  :\n              null\n            }</li>\n        );\n      })\n    }\n\n    return (\n      <div className={classes.Chat}>\n      { authRedirect }\n      { !this.props.recipient ?\n        <div className={classes.UserList}>\n          <ul>{ userList }</ul>\n        </div> :\n        <div\n          className={classes.Main}\n          ref={(chat) => this._chatWindow = chat}>\n          { chatWindow }\n        </div>\n      }\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  return {\n    isAuthenticated: state.token !== null,\n    token: state.token,\n    socket: state.socket,\n    user: state.user,\n    onlineUsers: state.onlineUsers,\n    recipient: state.recipient,\n    messages: state.messages\n  }\n}\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    onLogoutUser: (id) => dispatch(actions.logoutUser(id)),\n    onGetUsers: (token) => dispatch(actions.getUsers(token)),\n    onSetRecipient: (recipient, socket) => dispatch(actions.setRecipient(recipient, socket)),\n    onNewMsg: (data) => dispatch(actions.newMsg(data))\n  }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Chat);\n","import React, {Component} from 'react';\nimport { Route, Switch, withRouter, Redirect } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport * as actions from './store/actions/actions';\nimport socketIOClient from \"socket.io-client\";\nimport axios from './axios';\n\nimport './assets/style/style.css';\n\nimport Header from './containers/Header/Header';\nimport Auth from './containers/Auth/Auth';\nimport Chat from './containers/Chat/Chat';\n\nclass App extends Component {\n\n  UNSAFE_componentWillMount(){\n    \n    const socket = process.env.NODE_ENV === 'development'\n    ? socketIOClient('http://127.0.0.1:4001')\n    : socketIOClient('/');\n\n    this.props.onSetSocket(socket);\n\n    const token = localStorage.getItem('token');\n\n    if(token){\n      const exp = localStorage.getItem('exp');\n      if(exp > (new Date().getTime() / 1000)){\n        const user = JSON.parse(localStorage.getItem('user'));\n        this.props.onAuthenticated(token, user, exp, socket);\n\n        axios.get('/useronline/' + user._id, {\n          headers: {\n            Authorization: 'Bearer ' + token\n          }\n        }).then(response => {\n          console.log(response.data);\n        }).catch(err => console.log(err));\n\n        this.props.onGetUsers(token);\n      }\n    }\n\n    window.addEventListener('beforeunload', () => this.logoutRequest(this.props.user?._id, this.props.token));\n  }\n\n  logoutRequest = (user, token) => {\n    if(user && token){\n      this.props.onRemoveUser(user, token);\n    }\n  }\n\n  render(){\n    return (\n      <div className='App'>\n        <Header />\n        <Switch>\n          <Route path=\"/auth\" component={Auth} />\n          <Route path=\"/\" component={Chat} />\n          <Redirect to=\"/\" />\n        </Switch>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = state  => {\n  return {\n    isAuthenticated: state.token !== null,\n    user: state.user,\n    token: state.token\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return{\n    onRemoveUser: (id, token) => dispatch(actions.removeUser({userId: id}, token)),\n    onSetSocket: (socket) =>  dispatch(actions.setSocket(socket)),\n    onAuthenticated: (token, user, exp, socket) => dispatch(actions.authenticated(token, user, exp, socket)),\n    onGetUsers: (token) => dispatch(actions.getUsers(token)),\n  };\n}\n\nexport default withRouter(connect(mapStateToProps,mapDispatchToProps)(App));\n","import * as actionTypes from './actions/actionTypes';\nimport { v4 as uuidv4 } from 'uuid';\n\nconst initialState = {\n  token: null,\n  user: null,\n  recipient: null,\n  socket: null,\n  onlineUsers: {},\n  messages: {}\n}\n\nconst setUser = (state, action) => {\n  state.socket.emit('join', {\n    name: action.user.name,\n    id: action.user._id\n  });\n\n  return {\n    ...state,\n    token: action.token,\n    user: action.user\n  };\n}\n\nconst addUser = (state, action) => {\n  const updatedUsers = {...state.onlineUsers, ...action.user}\n  return {\n    ...state,\n    onlineUsers: updatedUsers\n  };\n}\n\nconst removeUser = (state, action) => {\n  const onlineUsers = {...state.onlineUsers};\n  delete onlineUsers[action.id];\n  return {\n    ...state,\n    onlineUsers: onlineUsers\n  };\n}\n\nconst newMsg = (state, action) => {\n  const { msg, user, recipient } = action.data;\n  const userId = state.user._id;\n  const timestamp = Date.now();\n  const newMessage = { timestamp, user, msg, id: uuidv4() };\n  const updatedMessages = {...state.messages};\n  const updatedUsers = {...state.onlineUsers};\n\n  let thread = null;\n\n  if(userId === user){\n    thread = recipient;\n  }else{\n    thread = user;\n    if(user !== state.recipient?.[0]){\n      const currentUser = {...state.onlineUsers[user]};\n      currentUser['unread'] ?\n      currentUser['unread']++ :\n      currentUser['unread'] = 1;\n\n      updatedUsers[user] = currentUser;\n    }\n    console.log('[user]', updatedUsers);\n  }\n\n  state.messages[thread] ?\n  updatedMessages[thread] = [...state.messages[thread], newMessage] :\n  updatedMessages[thread] = [newMessage];\n\n  return {\n    ...state,\n    messages: updatedMessages,\n    onlineUsers: updatedUsers\n  };\n}\n\nconst logoutUser = (state, action) => {\n  state.socket.emit('leaveChat', state.user._id);\n  return {\n    ...state,\n    token: null,\n    user: null,\n    recipient: null,\n  };\n}\n\nconst storeUsers = (state, action) => {\n  return {\n    ...state,\n    onlineUsers: action.data\n  }\n}\n\nconst unsetRecipient = (state, action) => {\n  return {\n    ...state,\n    recipient: null\n  }\n}\n\nconst setRecipient = (state, action) => {\n  const updatedUsers = {...state.onlineUsers};\n  const currentUser = {...state.onlineUsers[action.recipient[0]]};\n\n  currentUser['unread'] = false;\n  updatedUsers[action.recipient[0]] = currentUser;\n\n  console.log(currentUser);\n\n  return {\n    ...state,\n    recipient: action.recipient,\n    onlineUsers: updatedUsers\n  }\n}\n\nconst setSocket = (state, action) => {\n  return {\n    ...state,\n    socket: action.socket\n  }\n}\n\nconst reducer = (state = initialState, action) => {\n  switch (action.type){\n    case actionTypes.STORE_USERS: return storeUsers(state, action);\n    case actionTypes.SET_USER: return setUser(state, action);\n    case actionTypes.ADD_USER: return addUser(state, action);\n    case actionTypes.REMOVE_USER: return removeUser(state, action);\n    case actionTypes.NEW_MSG: return newMsg(state, action);\n    case actionTypes.LOGOUT_USER: return logoutUser(state, action);\n    case actionTypes.SET_RECIPIENT: return setRecipient(state, action);\n    case actionTypes.UNSET_RECIPIENT: return unsetRecipient(state, action);\n    case actionTypes.SET_SOCKET: return setSocket(state, action);\n    default: return state;\n  }\n}\n\nexport default reducer;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { BrowserRouter } from 'react-router-dom';\nimport { Provider } from 'react-redux';\nimport { createStore,  applyMiddleware, compose } from 'redux';\nimport thunk from 'redux-thunk';\n\nimport './index.css';\nimport App from './App';\nimport reducer from './store/reducer';\n\nconst composeEnhancers = process.env.NODE_ENV === 'development'\n? window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose\n: null;\n\nconst store = createStore(reducer,composeEnhancers(applyMiddleware(thunk)));\n\nconst app = (\n  <Provider store={store}>\n    <BrowserRouter>\n      <App />\n    </BrowserRouter>\n  </Provider>\n)\n\nReactDOM.render(app, document.getElementById('root'));\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Input\":\"Input_Input__3r5Ke\",\"Label\":\"Input_Label__1qyHr\",\"LabelInvalid\":\"Input_LabelInvalid__3d-81\",\"InputElement\":\"Input_InputElement__2m88K\",\"Invalid\":\"Input_Invalid__16Mis\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Chat\":\"Chat_Chat__lgG6O\",\"UserList\":\"Chat_UserList__3Cv8B\",\"Main\":\"Chat_Main__xq6Ur\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Auth\":\"Auth_Auth__1Zul_\",\"FormArea\":\"Auth_FormArea__3l6F0\",\"Submit\":\"Auth_Submit__38lFt\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Header\":\"Header_Header__1xrSh\",\"Nav\":\"Header_Nav__3L4rV\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"String\":\"ChatString_String__2TK7_\",\"Left\":\"ChatString_Left__xAFyy\",\"Right\":\"ChatString_Right__7Vx9q\"};","module.exports = __webpack_public_path__ + \"static/media/header.0c3efb58.svg\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Submit\":\"chatSubmit_Submit__Qxdef\"};"],"sourceRoot":""}